<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <title>Clickaholic</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!--    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.min.js"><script-->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/fenlei.css">
    <script src="./js/jquery-3.6.0.min.js"></script>
    <style>
        .Categorie-fram {
            height: 500px; /* 根据实际需求调整高度 */
            overflow-y: auto; /* 当内容超出高度时显示垂直滚动条 */
        }

    </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark cyan fixed-top">
    <div class="container">
        <a class="navbar-brand" href="index.html">
            <img src="images/nav-logo.png" alt="nav-logo" loading="lazy">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent-4"
                aria-controls="navbarSupportedContent-4" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent-4">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="index.html">首页 <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="typelist.html">文章分类</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="articlepublish.html">文章发表 </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="allarticle.html">文章列表</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="articlemanage.html">我的文章</a>
                </li>
                <li class="nav-item" id="username-display" style="display: none;">
                    <a class="nav-link" href="#" id="logged-username"></a>
                </li>
                <li class="nav-item" id="login-register">
                    <a class="nav-link" href="login.html">登录 | 注册</a>
                </li>
                <li class="nav-item" id="logout" style="display: none;">
                    <a class="nav-link" href="#" onclick="logout()">退出</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<!--/.Navbar -->

<!-- Carousel Wrapper -->
<div id="carousel-thumb" class="carousel slide carousel-fade carousel-thumbnails" data-ride="carousel">
    <!--Slides-->
    <div class="carousel-inner" role="listbox">
        <div class="carousel-item active">
            <img class="d-block w-100" src="images/indexbg.jpg" alt="First slide" loading="lazy">
            <div class="gradient"></div>
            <div class="carousel-caption">
                <h1>Welcome to the LS Article Publishing System.
                </h1>
                <p class="lead">There are many animate-related articles here...</p>
                <a class="btn btn-primary" href="allarticle.html"><span>查看文章列表</span></a>
            </div>
        </div>
    </div>

    <section class="blog">
        <div class="container">
            <div class="row">
                <!-- 左侧内容 占宽的四分之一 -->
                <div class="col-lg-4 col-md-12 left-side">
                    <h2>My Recent Articles</h2>
                    <div id="articles-container">
                        <!-- 文章列表会通过JS动态加载到这里 -->
                    </div>
                </div>
<!--                右侧内容 占宽的四分之三-->
                <!--            <div class="col-8 Categorie-fram with-background">-->
                <!--                <h2 style="text-align: center;padding-bottom: 10px">Categories</h2>-->
                <!--                &lt;!&ndash; 分类导航 &ndash;&gt;-->
                <!--                <div class="categories-nav">-->
                <!--                    &lt;!&ndash; 分类按钮会通过JS动态加载 &ndash;&gt;-->
                <!--                </div>-->
                <!--                &lt;!&ndash; 分类文章列表 &ndash;&gt;-->
                <!--                <div class="article-categories">-->
                <!--                    &lt;!&ndash; 具体分类的文章列表会通过JS动态加载 &ndash;&gt;-->
                <!--                </div>-->
                <!--            </div>-->
                <div class="col-8 category-frame with-background" id="category-container">
                    <h2 style="text-align: center; padding-bottom: 10px; font-weight: bold;">Categories</h2>
                    <!-- 分类文章列表 -->
                    <div class="article-categories">
                        <!-- 分类文章块会通过JS动态加载 -->
                    </div>
                </div>


            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footyy" id="fixed-footer">
        <section class="footer-bottom">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li class="hidden">/</li>
                            <li><a href="typelist.html">About-us</a></li>
                            <li class="hidden">/</li>
                            <li><a href="mystories.html">My stories</a></li>
                            <li class="hidden">/</li>
                            <li><a href="destinations.html">Destinations</a></li>
                            <li class="hidden">/</li>
                            <li><a href="articlepublish.html">Gallery</a></li>
                            <li class="hidden">/</li>
                            <li><a href="articlemanage.html">Contact</a></li>
                        </ul>
                    </div>
                    <div class="col-md-12">
                        <p>(C) All Rights Reserved </p>
                    </div>
                </div>
            </div>
        </section>
    </footer>
    <script src="js/auth.js" defer></script>
    <script src="js/articleindex.js" defer></script>
    <script>
        // $(document).ready(function () {
        //     // 获取文章类别数据
        //     $.ajax({
        //         url: '/portal/findAllTypes',
        //         method: 'GET',
        //         dataType: 'json',
        //         success: function (response) {
        //             if (response.code === 200) {
        //                 const articleTypes = response.data;
        //                 const categoriesNav = $('.categories-nav');
        //                 const categoriesContainer = $('.article-categories');
        //                 categoriesNav.empty();
        //                 categoriesContainer.empty();
        //                 // 动态生成分类按钮
        //                 articleTypes.forEach(function (type, index) {
        //                     const buttonHtml = `
        //                     <button class="${index === 0 ? 'active' : ''}" data-type-id="${type.tid}">
        //                         ${type.tname}
        //                     </button>`;
        //                     categoriesNav.append(buttonHtml);
        //                 });
        //
        //                 // 加载第一个分类的文章
        //                 if (articleTypes.length > 0) {
        //                     loadArticles(articleTypes[0]);
        //                 }
        //
        //                 // 分类按钮点击事件
        //                 categoriesNav.on('click', 'button', function () {
        //                     // 切换激活状态
        //                     categoriesNav.find('button').removeClass('active');
        //                     $(this).addClass('active');
        //
        //                     // 根据分类 ID 加载对应的文章
        //                     const typeId = $(this).data('type-id');
        //                     const selectedType = articleTypes.find((type) => type.tid === typeId);
        //                     if (selectedType) {
        //                         loadArticles(selectedType);
        //                     }
        //                 });
        //
        //                 // 加载文章的方法
        //                 function loadArticles(type) {
        //                     categoriesContainer.empty();
        //                     let articlesHtml = '<ul>';
        //                     if (type.articles && type.articles.length > 0) {
        //                         type.articles.forEach(function (article) {
        //                             articlesHtml += `
        //                             <li>
        //                                 <a href="articledetail.html?hid=${article.hid}" target="_self">${article.title}</a>
        //                             </li>`;
        //                         });
        //                     } else {
        //                         articlesHtml += '<li>暂无文章</li>';
        //                     }
        //                     articlesHtml += '</ul>';
        //                     const categoryHtml = `
        //                     <div class="category-item">
        //                         <h4>${type.tname}</h4>
        //                         ${articlesHtml}
        //                     </div>`;
        //                     categoriesContainer.append(categoryHtml);
        //                 }
        //             } else {
        //                 alert('获取文章类别失败，请稍后再试。');
        //             }
        //         },
        //         error: function () {
        //             alert('获取文章类别失败，请检查网络连接或稍后再试。');
        //         },
        //     });
        // });
        $(document).ready(function () {
            // 获取文章类别及其文章数据
            $.ajax({
                url: '/portal/findAllTypes', // 假设后端接口返回每个分类的前5篇文章
                method: 'GET',
                dataType: 'json',
                success: function (response) {
                    if (response.code === 200) {
                        const articleTypes = response.data; // 包含类别及每个类别的文章
                        const categoriesContainer = $('#category-container .article-categories');
                        categoriesContainer.empty();
                        articleTypes.forEach(function (type) {
                            // 每个分类显示的HTML
                            let articlesHtml = '<ul>';
                            if (type.articles && type.articles.length > 0) {
                                type.articles.slice(0, 5).forEach(function (article) { // 每个分类最多加载5篇文章
                                    articlesHtml += `
                            <li>
                                <a href="articledetail.html?hid=${article.hid}" target="_self">${article.title}</a>
                            </li>`;
                                });
                            } else {
                                articlesHtml += '<li>暂无文章</li>';
                            }
                            articlesHtml += '</ul>';

                            const categoryHtml = `
                    <div class="category-item">
                        <h4>${type.tname}</h4>
                        ${articlesHtml}
                    </div>`;
                            categoriesContainer.append(categoryHtml);
                        });
                    } else {
                        alert('获取文章类别失败，请稍后再试。');
                    }
                },
                error: function () {
                    alert('获取文章类别失败，请检查网络连接或稍后再试。');
                },
            });
        });

    </script>

</div>
</body>

</html>
